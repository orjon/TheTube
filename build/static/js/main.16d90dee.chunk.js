(this["webpackJsonp2020-04_react_tfl"]=this["webpackJsonp2020-04_react_tfl"]||[]).push([[0],{19:function(e,t,a){},44:function(e,t,a){e.exports=a(87)},49:function(e,t,a){},68:function(e,t,a){},78:function(e,t,a){},79:function(e,t,a){},80:function(e,t,a){},81:function(e,t,a){},84:function(e,t,a){},85:function(e,t,a){},86:function(e,t,a){},87:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(39),c=a.n(r),s=(a(49),a(8)),o=a(42),l=a(9),u=a.n(l),d=a(13),m=a(1),v=a(2),p=a(4),f=a(3),h=a(12),b=a(17),k=a.n(b);a(68);var E=a(21),y=a.n(E),g=function(e){Object(p.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).state={},n.today=Date.now(),n}return Object(v.a)(a,[{key:"render",value:function(){return i.a.createElement("div",{className:"Nav"},i.a.createElement(s.b,{to:"/"},i.a.createElement("div",{className:"AppTitle"},"Transport for London API")),i.a.createElement("div",{className:"dateTime"},i.a.createElement(y.a,{className:"Time",format:"HH:mm",ticking:!0}),i.a.createElement(y.a,{className:"Date",format:"DD-MMM-YYYY",ticking:!0})))}}]),a}(n.Component),N=a(16),j=(a(78),function(e){Object(p.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).findStationFromId=function(e){return n.props.stations.filter((function(t){return t.id===e}))},n.findStationFromId=n.findStationFromId.bind(Object(N.a)(n)),n}return Object(v.a)(a,[{key:"lineName",value:function(e,t){var a=e.findIndex((function(e){return e.id===t}));return e[a].name}},{key:"lineId",value:function(e,t){var a=e.findIndex((function(e){return e.id===t}));return e[a].id}},{key:"render",value:function(){var e,t=this,a=this.props,n=a.station,r=a.tubeLines;a.stations,a.thisStation;return e=this.findStationFromId(n.id).pop().lines.map((function(e){var a="";return["hammersmith-city","waterloo-city","circle"].includes(e)&&(a="lightColor"),i.a.createElement(s.b,{key:e,to:"/line/".concat(t.lineId(r,e))},i.a.createElement("div",{className:"lineCell ".concat(e," ").concat(a)},t.lineName(r,e)))})),i.a.createElement("div",{className:"row lineStop"},i.a.createElement(s.b,{className:"w50 lineName",to:"/station/".concat(n.url)},n.name),i.a.createElement("div",{className:"column w50 linesBlock"},e))}}]),a}(n.Component));j.defaultProps={thisStation:{lines:[]},station:{id:void 0}};var O=j,w=(a(19),a(79),function(e){Object(p.a)(a,e);var t=Object(f.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(v.a)(a,[{key:"render",value:function(){var e=this.props,t=e.line,a=e.tubeLines,n=e.stations,r=t.stations.map((function(e){return i.a.createElement(O,{key:e.id,station:e,stations:n,tubeLines:a})})),c="";return["hammersmith-city","waterloo-city","circle"].includes(t.id)&&(c="lightColor"),console.log("line: ",t.id),i.a.createElement("section",null,i.a.createElement("div",{className:"CardSingle"},i.a.createElement("div",{className:"Card"},i.a.createElement("div",{className:"row lineColor ".concat(t.id)},i.a.createElement("div",{className:"".concat(c)},t.name)),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"column w100 indent1"},i.a.createElement("h2",null,"Stations Served (",t.stations.length,")"),i.a.createElement("div",{className:"LineStops dataBlock indent2"},r))))))}}]),a}(n.Component));w.defaultProps={line:{id:"loading...",name:"loading...",stations:[]},tubeLines:{},stations:[]};var S=w,x=(a(80),function(e){Object(p.a)(a,e);var t=Object(f.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(v.a)(a,[{key:"render",value:function(){var e=this.props.line,t="";if(e.reason){var a=(t=e.reason).indexOf(":")+1;t=t.substring(a)}var n="";return["hammersmith-city","waterloo-city","circle"].includes(e.id)&&(n="lightColor"),i.a.createElement("div",{className:"LineStatus"},i.a.createElement(s.b,{to:"/line/".concat(e.id)},i.a.createElement("div",{className:"Card"},i.a.createElement("div",{className:"row lineColor ".concat(e.id)},i.a.createElement("div",{className:"".concat(n)},e.name)),i.a.createElement("div",{className:"row titleRow"},i.a.createElement("div",{className:"status"},e.status)),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"data"},t)))))}}]),a}(n.Component)),L=function(e){Object(p.a)(a,e);var t=Object(f.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(v.a)(a,[{key:"render",value:function(){var e=this.props.tubeLines.map((function(e){return i.a.createElement(x,{key:e.id,line:e})}));return i.a.createElement("section",null,i.a.createElement("div",{className:"sectionBody CardGrid"},e))}}]),a}(n.Component),C=a(88),I=a(24),A=a.n(I);A.a.accessToken="pk.eyJ1Ijoib3Jqb24iLCJhIjoiY2s5bnh3eDdjMDZqajNvcHA5MHZ6bWZxdiJ9.tuIb9BBBqKJfRW6Otc4RYw";var B=function(e){Object(p.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).state={lng:n.props.lng,lat:n.props.lat,zoom:15},n.markers=[],n}return Object(v.a)(a,[{key:"componentDidMount",value:function(){new A.a.Map({container:this.mapDiv,style:"mapbox://styles/mapbox/streets-v11",center:[this.state.lng,this.state.lat],zoom:this.state.zoom})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"row map",ref:function(t){return e.mapDiv=t}})}}]),a}(i.a.Component),D=(a(81),a(37),a(38),function(e){Object(p.a)(a,e);var t=Object(f.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(v.a)(a,[{key:"render",value:function(){var e=this.props.line,t=this.props.arrivals.filter((function(t){return t.lineId===e.id})).map((function(e){return i.a.createElement("div",{className:"row",key:Object(C.a)()},i.a.createElement("div",null,e.towards),i.a.createElement("div",{className:"end"},e.expected))})),a=!1;0===t.length&&(a=!0);var n="";return["hammersmith-city","waterloo-city","circle"].includes(e.id)&&(n="lightColor"),i.a.createElement("div",{className:"column dataBlock indent2"},i.a.createElement(s.b,{className:"row",to:"/line/".concat(e.id)},i.a.createElement("div",{className:"column w100 b1"},i.a.createElement("div",{key:e.id,className:"row lineColor ".concat(e.id)},i.a.createElement("div",{className:"".concat(n)},e.name)),i.a.createElement("div",{className:"row linkTo"},i.a.createElement("div",{className:"status"},e.status)))),!a&&i.a.createElement("div",{className:"row"},i.a.createElement("h4",{className:"infoLabel"},"Towards"),i.a.createElement("h4",{className:"infoLabel end"},"Expected Arrival")),t)}}]),a}(n.Component)),P=(a(84),function(e){Object(p.a)(a,e);var t=Object(f.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(v.a)(a,[{key:"render",value:function(){var e=this.props.facilities;return e=e.map((function(e){return i.a.createElement("div",{key:e.key,className:"w25 column"},e.key)})),i.a.createElement("div",{className:"Facilities dataBlock indent2"},e)}}]),a}(n.Component));P.defaultProps={facilities:[]};var T=P,M=(a(85),function(e){Object(p.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).state={arrivals:[],station:n.props.station},n.getArrivals=n.getArrivals.bind(Object(N.a)(n)),n}return Object(v.a)(a,[{key:"getArrivals",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,a,n,i,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,a=t.apiString,n=t.station,i=n.id,r=[],e.next=5,k.a.get("https://api.tfl.gov.uk/StopPoint/".concat(i,"/Arrivals?").concat(a),{headers:{Accept:"application/json"}});case 5:e.sent.data.map((function(e){return r.push({lineName:e.lineName,lineId:e.lineId,platform:e.platformName,desintation:e.destination,towards:e.towards,expected:e.expectedArrival})})),this.setState({arrivals:[].concat(r)});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.props.getInfo;this.getArrivals()}},{key:"formatLocation",value:function(e,t){return t>=0?t+="\xb0E":t=-t+"\xb0W",{lat:e+="\xb0N",lng:t}}},{key:"formatAddress",value:function(e){return e=(e=e.split(",")).map((function(e){return i.a.createElement("div",{key:Object(C.a)()},e)}))}},{key:"findLine",value:function(e,t){var a=e.findIndex((function(e){return e.id===t}));return e[a]}},{key:"render",value:function(){var e=this,t=this.props,a=t.station,n=t.tubeLines,r=a.lines.map((function(t){return i.a.createElement(D,{key:t,line:e.findLine(n,t),arrivals:e.state.arrivals})})),c=a.contact[0].value;c=this.formatAddress(c);var s=a.contact[1].value,o=this.formatLocation(a.lat,a.lng);return i.a.createElement("section",null,i.a.createElement("div",{className:"CardSingle"},i.a.createElement("div",{className:"Card"},i.a.createElement("div",{className:"row"},i.a.createElement("h1",null,a.name)),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"column w100 indent1"},i.a.createElement("h2",null,"Arrivals"),r)),i.a.createElement("div",{className:"row facilities"},i.a.createElement("div",{className:"column w100 indent1"},i.a.createElement("h2",null,"Facilities"),i.a.createElement(T,{facilities:a.facilities}))),i.a.createElement("div",{className:"row address"},i.a.createElement("div",{className:"column w50 indent1"},i.a.createElement("h2",null,"Address"),i.a.createElement("div",{className:"column dataBlock indent2"},c)),i.a.createElement("div",{className:"column w50 indent1"},i.a.createElement("h2",null,"Telephone"),i.a.createElement("div",{className:"column dataBlock indent2"},s))),i.a.createElement("div",{className:"row rowLast"},i.a.createElement("div",{className:"column w100 indent2"},i.a.createElement(B,{lat:a.lat,lng:a.lng}),i.a.createElement("div",{className:"row"},i.a.createElement("div",null,o.lat," ",o.lng),i.a.createElement("div",{className:"code"},"Station ID: ",a.id)))))))}}]),a}(n.Component));M.defaultProps={station:{id:void 0,url:"loading...",name:"loading...",address:"",lat:0,lng:0,lines:[],contact:[{value:"the address"},{value:"the phone number"}]}};var R=M,J=(a(86),function(e){Object(p.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).findLine=function(e){return n.state.tubeLines.find((function(t){return t.id===e}))},n.findStationFromUrl=function(e){return n.state.stations.find((function(t){return t.url===e}))},n.findStationFromId=function(e){return n.state.stations.findIndex((function(t){return t.id===e}))},n.findLineIndex=function(e){return n.state.tubeLines.findIndex((function(t){return t.id===e}))},n.state={tubeLines:[],stations:[]},n}return Object(v.a)(a,[{key:"componentDidMount",value:function(){0===this.state.tubeLines.length&&this.getInfo()}},{key:"getInfo",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,a,n,i,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Getting statuses..."),e.next=3,this.getStatuses();case 3:t=e.sent,console.log("Getting stop orders..."),a=0;case 6:if(!(a<t.length)){e.next=13;break}return e.next=9,this.getStopOrder(t[a].id);case 9:t[a].stopOrder=e.sent;case 10:a++,e.next=6;break;case 13:n=[],i=0;case 15:if(!(i<t.length)){e.next=23;break}return e.next=18,this.getStations(t[i].id);case 18:for(t[i].stations=e.sent,r=0;r<t[i].stations.length;r++)t[i].stations[r].lines=[t[i].id],n=this.addStation(t[i].stations[r],n);case 20:i++,e.next=15;break;case 23:n.sort(this.compare),this.setState({tubeLines:t,stations:n});case 25:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getStatuses",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.apiString,a=[],e.next=4,k.a.get("https://api.tfl.gov.uk/line/mode/tube/status?".concat(t),{headers:{Accept:"application/json"}});case 4:return n=e.sent,n.data.map((function(e){return a.push({key:e.id,id:e.id,name:e.name,status:e.lineStatuses[0].statusSeverityDescription,reason:e.lineStatuses[0].reason,stopOrder:[]})})),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getStopOrder",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var a,n,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.props.apiString,e.next=3,k.a.get("https://api.tfl.gov.uk/Line/".concat(t,"/Route/Sequence/all?").concat(a),{headers:{Accept:"application/json"}});case 3:return n=e.sent,i=n.data.orderedLineRoutes,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkProperties",value:function(e){return e=e?e.value:void 0}},{key:"getStations",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var a,n,i=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.props.apiString,n=[],e.next=4,k.a.get("https://api.tfl.gov.uk/Line/".concat(t,"/StopPoints?tflOperatedNationalRailStationsOnly=false&").concat(a),{headers:{Accept:"application/json"}});case 4:return e.sent.data.map((function(e){var t=[{key:"Address",value:void 0},{key:"PhoneNo",value:void 0}],a=[],r=["no","0"],c=["TaxiRankOutsideStation"];[{key:"Ticket Halls",value:void 0},{key:"Toilets",value:void 0},{key:"Lifts",value:void 0},{key:"Escalators",value:void 0},{key:"WiFi",value:void 0},{key:"Help Points",value:void 0},{key:"Payphones",value:void 0},{key:"Boarding Ramp",value:void 0},{key:"Cash Machines",value:void 0},{key:"Euro Cash Machines",value:void 0},{key:"Waiting Room",value:void 0},{key:"TaxiRankOutsideStation",value:void 0},{key:"Car park",value:void 0},{key:"Left Luggage",value:void 0},{key:"Photo Booths",value:void 0},{key:"Amazon Lockers",value:void 0},{key:"ASDA Click and Collect",value:void 0}].forEach((function(t){var n=e.additionalProperties.find((function(e){return e.key===t.key}));if(n&&c.includes(t.key)&&(t.key="Taxi Rank"),n&&!r.includes(n.value))return t.value=n.value,void a.push(t)}));var s,o=[];return t.forEach((function(t){var a=e.additionalProperties.find((function(e){return e.key===t.key}));if(a&&!r.includes(a.value))return t.value=a.value,void o.push(t)})),n.push({key:e.id,id:e.id,url:(s=i.trimStationName(e.commonName),s.toLowerCase().replace(/ /g,"-").replace(/'/g,"")),name:i.trimStationName(e.commonName),lat:e.lat,lng:e.lon,contact:[].concat(o),facilities:a})})),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"trimStationName",value:function(e){var t=e.replace("Underground Station",""),a=t.indexOf("(")+2;return 0!==a&&(t=t.slice(0,a-2)),t}},{key:"addStation",value:function(e,t){var a=t.findIndex((function(t){return t.id===e.id}));return-1!==a?t[a].lines.push(e.lines[0]):t=[].concat(Object(o.a)(t),[e]),t}},{key:"compare",value:function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"App"},i.a.createElement("header",null,i.a.createElement(g,null)),i.a.createElement(h.c,null,i.a.createElement(h.a,{exact:!0,path:"/",render:function(t){return i.a.createElement(L,Object.assign({},t,{tubeLines:e.state.tubeLines}))}}),i.a.createElement(h.a,{exact:!0,path:"/tube/status",render:function(t){return i.a.createElement(L,Object.assign({},t,{tubeLines:e.state.tubeLines}))}}),i.a.createElement(h.a,{exact:!0,path:"/line/:id",render:function(t){return i.a.createElement(S,Object.assign({},t,{tubeLines:e.state.tubeLines,stations:e.state.stations,line:e.findLine(t.match.params.id)}))}}),i.a.createElement(h.a,{exact:!0,path:"/station/:url",render:function(t){return i.a.createElement(R,Object.assign({},t,{tubeLines:e.state.tubeLines,apiString:e.props.apiString,station:e.findStationFromUrl(t.match.params.url),getInfo:e.getInfo}))}})),i.a.createElement("footer",{className:"right"},i.a.createElement("a",{href:"http://www.orjon.com"},"orjon.com")))}}]),a}(n.Component));J.defaultProps={apiString:"app_id=".concat("962fdb33","&app_key=").concat("b3f162b49250feb509d5823ae3a89262"),mapboxToken:"pk.eyJ1Ijoib3Jqb24iLCJhIjoiY2s5bnh3eDdjMDZqajNvcHA5MHZ6bWZxdiJ9.tuIb9BBBqKJfRW6Otc4RYw"};var F=J;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement(s.a,null,i.a.createElement(F,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[44,1,2]]]);
//# sourceMappingURL=main.16d90dee.chunk.js.map